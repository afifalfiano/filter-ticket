"use strict";(self.webpackChunkfilter_ticket=self.webpackChunkfilter_ticket||[]).push([[454],{49454:function(e,a,t){t.r(a),t.d(a,{default:function(){return y}});var n=t(74165),l=t(15861),s=t(1413),i=t(70885),r=t(95048),o=t(72791),c=t(26290),d=t(92044),u=t(35823),m=t(55705),p=t(26968),f=t(86017),h=t(76899),v=t(2512),x=t(41240),j=t(15738),k=t(89504),Z=t(11803),b=t(19585),g=t(14450),N=t(80184);var w=function(e){var a=e.stateModal,t=e.getInfo,c=e.detail,d=e.titleAction,w=(0,u.Ht)(),_=(0,i.Z)(w,1)[0],y=(0,r.v9)(p.HF).data,S={name:(null===c||void 0===c?void 0:c.name)||"",email:(null===c||void 0===c?void 0:c.email)||"",pop_id:(null===c||void 0===c?void 0:c.pop_id)||"",role_id:(null===c||void 0===c?void 0:c.role_id)||""},C=(0,o.useState)(null),M=(0,i.Z)(C,2)[1],U=(0,o.useState)(null),A=(0,i.Z)(U,2)[1],H=(0,r.v9)(j.n5),F=(0,r.v9)(x.Yq),I=(0,r.I0)(),P=(0,h.HY)(),B=(0,i.Z)(P,1)[0],z=(0,v.LN)(),E=(0,i.Z)(z,1)[0],T=function(){var e=(0,s.Z)((0,s.Z)({},a),{},{user:(0,s.Z)((0,s.Z)({},a.user),{},{showUpdateModalUser:!1,showActivateModalUser:!1,showDeactivateModalUser:!1})});I((0,k.cf)(e))},D=function(){var e=(0,l.Z)((0,n.Z)().mark((function e(){var a,t,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B().unwrap();case 3:"success"===(a=e.sent).status||"Success"===a.status?(I((0,x.pk)((0,s.Z)({},a))),l=null===F||void 0===F||null===(t=F.data)||void 0===t?void 0:t.find((function(e){return e.id_pop===y.pop_id})),A(l)):(0,Z.Z)(a,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,Z.Z)(e.t0,!0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,l.Z)((0,n.Z)().mark((function e(){var a,t,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E().unwrap();case 3:"success"===(a=e.sent).status||"Success"===a.status?(I((0,j.g4)((0,s.Z)({},a))),l=null===H||void 0===H||null===(t=H.data)||void 0===t?void 0:t.find((function(e){return+e.id_role===+(null===y||void 0===y?void 0:y.role_id)})),M(l)):(0,Z.Z)(a,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),(0,Z.Z)(e.t0,!0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){D(),R()}),[]);var L=function(){var e=(0,l.Z)((0,n.Z)().mark((function e(a,l){var i,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={name:a.name,email:a.email,role_id:null===a||void 0===a?void 0:a.role_id,pop_id:a.pop_id},e.prev=1,e.next=4,_({id:c.id_user,body:(0,s.Z)((0,s.Z)({},i),{},{id_user:c.id_user})});case 4:"success"===(r=e.sent).data.status||"Success"===r.data.status?((0,b.Z)(r),setTimeout((function(){t({status:"success"}),T()}),2e3)):(0,Z.Z)(r,!0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),(0,Z.Z)(e.t0,!0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(a,t){return e.apply(this,arguments)}}(),Y=function(e){e(),T()};return(0,N.jsx)("div",{className:"fixed w-screen h-screen bg-opacity-80 bg-gray-700 top-0 left-0 bottom-0 right-0 z-50 flex justify-center",children:(0,N.jsxs)("div",{className:"modal-box h-fit max-h-fit max-w-lg",children:[(0,N.jsx)(g.b_,{onClick:T}),(0,N.jsxs)("h3",{className:"text-lg font-bold",children:[null===c&&"create"===d?"Tambah User":"update"===d&&"Ubah User","read"===d&&"Detail User"]}),(0,N.jsx)("hr",{className:"my-2"}),(0,N.jsx)(m.J9,{enableReinitialize:!0,initialValues:S,validationSchema:f.yL,onSubmit:function(e,a){var t=a.resetForm;L(e,t)},children:function(e){var a,t,n=e.values,l=e.errors,s=e.touched,i=e.isValid,r=e.handleBlur,o=e.handleChange,c=e.resetForm;return(0,N.jsxs)(m.l0,{children:[(0,N.jsxs)("div",{className:"form-control",children:[(0,N.jsx)("label",{htmlFor:"name",className:"label",children:(0,N.jsx)("span",{className:"label-text",children:" Nama:"})}),(0,N.jsx)(m.gN,{id:"name",name:"name",placeholder:"Name",value:n.name,onBlur:r,onChange:o,className:"input input-md input-bordered  max-w-full"}),l.name&&s.name&&(0,N.jsx)(g.aH,{errors:l.name})]}),(0,N.jsxs)("div",{className:"form-control",children:[(0,N.jsx)("label",{htmlFor:"email",className:"label",children:(0,N.jsx)("span",{className:"label-text",children:" email:"})}),(0,N.jsx)(m.gN,{id:"email",name:"email",type:"email",component:"input",placeholder:"Email",value:n.email,onBlur:r,onChange:o,className:"input input-md input-bordered  max-w-full"}),l.email&&s.email&&(0,N.jsx)(g.aH,{errors:l.email})]}),(0,N.jsxs)("div",{className:"form-control",children:[(0,N.jsx)("label",{htmlFor:"team",className:"label",children:(0,N.jsx)("span",{className:"label-text",children:" Tim:"})}),(0,N.jsx)(m.gN,{component:"select",id:"role_id",name:"role_id",value:null===n||void 0===n?void 0:n.role_id,onBlur:r,onChange:o,className:"select w-full max-w-full input-bordered",children:null===H||void 0===H||null===(a=H.data)||void 0===a?void 0:a.map((function(e,a){return(0,N.jsx)("option",{id:e.id_role,value:e.id_role,label:e.role,children:e.role},a)}))})]}),(0,N.jsxs)("div",{className:"form-control",children:[(0,N.jsx)("label",{htmlFor:"location",className:"label",children:(0,N.jsx)("span",{className:"label-text",children:" POP (Area Operasional):"})}),(0,N.jsx)(m.gN,{component:"select",id:"pop_id",name:"pop_id",value:n.pop_id,onBlur:r,onChange:o,className:"select w-full max-w-full input-bordered",children:null===F||void 0===F||null===(t=F.data)||void 0===t?void 0:t.map((function(e,a){return(0,N.jsx)("option",{value:e.id_pop,label:e.pop,children:e.pop},a)}))})]}),(0,N.jsx)("hr",{className:"my-2 mt-10"}),"read"!==d&&(0,N.jsxs)("div",{className:"modal-action justify-center",children:[(0,N.jsx)(g.zx,{type:"button",onClick:function(){return Y(c)},children:"Batal"}),(0,N.jsx)(g.zx,{type:"submit",className:"btn-success",disabled:!i,children:"Simpan"})]}),"read"===d&&(0,N.jsx)("div",{className:"modal-action justify-center",children:(0,N.jsx)(g.zx,{type:"button",onClick:function(){return Y(c)},children:"Kembali"})})]})}})]})})},_=["No","Nama","Email","Role Id","Pop Id","Status","Aksi"];var y=function(){var e,a,t,m=(0,r.I0)(),p=(0,o.useState)([]),f=(0,i.Z)(p,2),h=f[0],v=f[1],x=(0,u.EC)(),j=(0,i.Z)(x,2),b=j[0],y=j[1].isLoading,S=(0,o.useState)(null),C=(0,i.Z)(S,2),M=C[0],U=C[1],A=(0,o.useState)(""),H=(0,i.Z)(A,2),F=H[0],I=H[1],P=(0,o.useState)("update"),B=(0,i.Z)(P,2),z=B[0],E=B[1],T=(0,r.v9)(d.yw),D=(0,o.useState)(1),R=(0,i.Z)(D,2),L=R[0],Y=R[1],O=(0,o.useState)([5]),V=(0,i.Z)(O,2),q=V[0],J=V[1],K=(0,o.useState)([1]),W=(0,i.Z)(K,2),G=W[0],Q=W[1],X=(0,r.v9)(k.HH),$=function(e){var a;"update"===e?a=(0,s.Z)((0,s.Z)({},X),{},{user:(0,s.Z)((0,s.Z)({},X.user),{},{showUpdateModalUser:!0})}):"aktifkan"===e?a=(0,s.Z)((0,s.Z)({},X),{},{user:(0,s.Z)((0,s.Z)({},X.user),{},{showActivateModalUser:!0})}):"nonaktifkan"===e&&(a=(0,s.Z)((0,s.Z)({},X),{},{user:(0,s.Z)((0,s.Z)({},X.user),{},{showDeactivateModalUser:!0})})),m((0,k.cf)(a)),window.scrollTo(0,0)},ee=function(){var e=(0,l.Z)((0,n.Z)().mark((function e(){var a,t,l,s,i,r,o=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>0&&void 0!==o[0]?o[0]:1,t="?page=".concat(a),e.prev=2,e.next=5,b(t).unwrap();case 5:if("success"===(l=e.sent).status||"Success"===l.status){for(s=l.data.data,m((0,d.HM)({data:s})),v(s),Y(l.data.current_page),J([l.data.per_page]),i=[],r=0;r<l.data.last_page;r++)i.push(r+1);Q(i)}else v([]),(0,Z.Z)(l,!0);e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),v([]),(0,Z.Z)(e.t0,!0);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),ae=function(e){"success"===e.status&&ee()};return(0,o.useEffect)((function(){m((0,c.oi)([{path:"/users",title:"Pengaturan Pengguna"}])),ee()}),[]),(0,N.jsxs)("div",{children:[!y&&(0,N.jsx)("div",{className:"gap-5 mt-5 flex flex-col md:flex md:flex-row",children:(0,N.jsx)(g.ol,{search:F,onHandleSearch:function(e){if(I(e.target.value),e.target.value.length>0){var a=new RegExp(F,"ig"),t=T.data.filter((function(e){return e.name.match(a)||e.email.match(a)}));v(t)}else v(T.data)},placeholder:"Cari data pengguna..."})}),(0,N.jsxs)(g.u_,{children:[(null===X||void 0===X||null===(e=X.user)||void 0===e?void 0:e.showUpdateModalUser)&&(0,N.jsx)(w,{stateModal:X,getInfo:ae,detail:M,titleAction:z}),(null===X||void 0===X||null===(a=X.user)||void 0===a?void 0:a.showActivateModalUser)&&(0,N.jsx)(g.pf,{stateModal:X,getInfo:ae,detail:M,title:"Aktifkan user",message:"Apakah anda yakin akan mengaktifkan",titleModal:"",titleAction:"Aktifkan"}),(null===X||void 0===X||null===(t=X.user)||void 0===t?void 0:t.showDeactivateModalUser)&&(0,N.jsx)(g.pf,{stateModal:X,getInfo:ae,detail:M,title:"Nonaktifkan user",message:"Apakah anda yakin akan menonaktifkan",titleModal:"",titleAction:"Nonaktifkan"})]}),y&&(0,N.jsx)(g.cY,{countRows:8,countColumns:10,totalFilter:1}),!y&&(0,N.jsx)("div",{className:"overflow-x-auto mt-8",children:(0,N.jsxs)("table",{className:"table table-zebra w-full",children:[(0,N.jsx)("thead",{children:(0,N.jsx)("tr",{children:_.map((function(e,a){return(0,N.jsx)("th",{className:"text-center",children:e},a)}))})}),(0,N.jsx)("tbody",{children:h.map((function(e,a){var t,n;return(0,N.jsxs)("tr",{className:"text-center",children:[(0,N.jsx)("td",{children:a+1}),(0,N.jsx)("td",{children:e.name}),(0,N.jsx)("td",{children:e.email}),(0,N.jsx)("td",{children:null===e||void 0===e||null===(t=e.role)||void 0===t?void 0:t.role}),(0,N.jsx)("td",{children:null===e||void 0===e||null===(n=e.pop)||void 0===n?void 0:n.pop}),(0,N.jsx)("td",{children:e.aktif?(0,N.jsx)("span",{className:"badge badge-success text-white",children:"Aktif"}):(0,N.jsx)("span",{className:"badge badge-error text-white",children:"Tidak aktif"})}),(0,N.jsx)("td",{children:(0,N.jsxs)("div",{className:"flex flex-row gap-3 justify-center",children:[(0,N.jsx)(g.W,{onClick:function(){return function(e){U(e),E("update"),$("update")}(e)}}),e.aktif&&(0,N.jsx)(g.fB,{onClick:function(){return function(e){U(e),E("nonaktifkan"),$("nonaktifkan")}(e)}}),!e.aktif&&(0,N.jsx)(g.Uj,{onClick:function(){return function(e){U(e),E("aktifkan"),$("aktifkan")}(e)}})]})})]},a)}))})]})}),!y&&(0,N.jsx)(g.tl,{perPage:q,currentPage:L,countPage:G,onClick:function(e){return ee(e.target.id)},serverMode:!0})]})}}}]);
//# sourceMappingURL=454.de713895.chunk.js.map