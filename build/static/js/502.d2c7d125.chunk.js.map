{"version":3,"file":"static/js/502.d2c7d125.chunk.js","mappings":"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","sources":["webpack://filter-ticket/./src/pages/dashboard/modal/ComplainModalForm.module.css?e04f","pages/dashboard/modal/ComplainModalForm.jsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"modal-box-custom\":\"ComplainModalForm_modal-box-custom__XYJEH\",\"modal-open\":\"ComplainModalForm_modal-open__Z7JH4\",\"modal-toggle\":\"ComplainModalForm_modal-toggle__sjD3u\",\"modal\":\"ComplainModalForm_modal__+WYV6\",\"modal-bottom\":\"ComplainModalForm_modal-bottom__rg6c-\",\"modal-middle\":\"ComplainModalForm_modal-middle__fMLf1\",\"modal-box-2\":\"ComplainModalForm_modal-box-2__Y3Ybl\"};","import { useState } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { Formik, Field, Form } from 'formik';\r\nimport { useSelector } from 'react-redux';\r\nimport { selectCurrentUser } from '../../../store/features/auth/authSlice';\r\nimport styles from './ComplainModalForm.module.css';\r\nimport { useAddComplainMutation, useLampiranFileMutation, useUpdateComplainMutation } from '../../../store/features/complain/complainApiSlice';\r\nimport { selectAllPOP } from '../../../store/features/pop/popSlice';\r\nimport { selectAllSumberKeluhan } from '../../../store/features/sumber_keluhan/sumberKeluhanSlice';\r\nimport { ComplainFormSchema } from '../../../utils/schema_validation_form';\r\nimport { setModal } from '../../../store/features/modal/modalSlice';\r\nimport { usePostNotificationMutation, useStoreAllNotificationMutation } from '../../../store/features/notification/notificationApiSlice';\r\nimport catchError from '../../../services/catchError';\r\nimport handleResponse from '../../../services/handleResponse';\r\nimport { ButtonIconExit, Button, TextEditor, UploadFile } from '../../../components';\r\n\r\nfunction ComplainModalForm({ stateModal, getInfo, detail }) {\r\n  const [addComplain] = useAddComplainMutation();\r\n  const [updateComplain] = useUpdateComplainMutation();\r\n  const { data: user } = useSelector(selectCurrentUser);\r\n  const popData = useSelector(selectAllPOP);\r\n  const [filesLocal, setFilesLocal] = useState([]);\r\n  const [kategoriPelanggan,] = useState([\r\n    {\r\n      label: 'REGISTERED',\r\n      value: 'REGISTERED'\r\n    },\r\n    {\r\n      label: 'UNREGISTERED',\r\n      value: 'UNREGISTERED',\r\n    }\r\n  ]);\r\n  const dispatch = useDispatch();\r\n  const dataSumber = useSelector(selectAllSumberKeluhan);\r\n  const [lampiranFile] = useLampiranFileMutation();\r\n  const [postNotification] = usePostNotificationMutation();\r\n  const [storeAllNotification] = useStoreAllNotificationMutation()\r\n\r\n  const initialValues = {\r\n    kategori_pelanggan: detail?.kategori_pelanggan || '',\r\n    id_pelanggan: detail?.id_pelanggan || '',\r\n    nama_pelanggan: detail?.nama_pelanggan || '',\r\n    nama_pelapor: detail?.nama_pelapor || '',\r\n    nomor_pelapor: detail?.nomor_pelapor || '',\r\n    nomor_keluhan: detail?.nomor_keluhan || '',\r\n    sumber: detail?.sumber_id || '',\r\n    detail_sumber: detail?.detail_sumber || '',\r\n    keluhan: detail?.keluhan || '',\r\n    status: detail?.status || '',\r\n    pop_id: detail?.pop_id || '',\r\n  };\r\n\r\n\r\n  const onBtnClose = () => {\r\n    const newState = {\r\n      ...stateModal,\r\n      dashboard: { ...stateModal.dashboard, showAddModalComplain: false, showUpdateModalComplain: false },\r\n    };\r\n    dispatch(setModal(newState));\r\n  };\r\n\r\n  const doStoreAllNotiification = async (notifikasi_id) => {\r\n    try {\r\n      const body = {\r\n        notifikasi_id,\r\n      }\r\n      const data = await storeAllNotification({ body }).unwrap();\r\n      return data;\r\n    } catch (error) {\r\n      catchError(error, true);\r\n    }\r\n  }\r\n\r\n  const doPostNotification = async (keluhan_id) => {\r\n    try {\r\n      const body = {\r\n        keluhan_id,\r\n        pop_id: user.pop_id,\r\n        id_response: 0\r\n      }\r\n      const data = await postNotification({ body }).unwrap();\r\n      return data;\r\n    } catch (error) {\r\n      catchError(error, true);\r\n    }\r\n  }\r\n\r\n\r\n  const testSentimentData = async (payload) => {\r\n    const test = {\r\n      string: payload.keluhan,\r\n    }\r\n    const sentimen = await fetch('https://tediyanwibowo.pythonanywhere.com/model', {\r\n      method: 'POST',\r\n      mode: 'cors',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(test),\r\n    });\r\n    const resultSentimen = await sentimen.json()\r\n    return resultSentimen;\r\n  }\r\n\r\n  const onSubmitData = async (payload, resetForm) => {\r\n    try {\r\n      // create\r\n      if (detail === null) {\r\n        const request = await testSentimentData(payload);\r\n        if (request.hasOwnProperty('sentiment')) {\r\n          const body = {\r\n            kategori_pelanggan: payload.kategori_pelanggan,\r\n            id_pelanggan: payload.id_pelanggan,\r\n            nama_pelanggan: payload.nama_pelanggan,\r\n            nama_pelapor: payload.nama_pelapor,\r\n            nomor_pelapor: payload.nomor_pelapor,\r\n            sumber_id: payload.sumber,\r\n            detail_sumber: payload.detail_sumber,\r\n            keluhan: payload.keluhan,\r\n            status: 'open',\r\n            pop_id: payload.pop_id,\r\n            user_id: user.id_user,\r\n            sentimen_analisis: request.sentiment,\r\n            lampiran: '',\r\n          };\r\n          doCreate(body, resetForm);\r\n        }\r\n      } else {\r\n        doUpdateComplain(payload);\r\n      }\r\n    } catch (error) {\r\n      catchError(error, true);\r\n    }\r\n  };\r\n\r\n  const doCreate = async (body, resetForm) => {\r\n    const add = await addComplain({ ...body });\r\n    if (add.data.status === 'success' || add.data.status === 'Success') {\r\n      handleResponse(add);\r\n\r\n      if (filesLocal.length > 0) {\r\n        const formData = new FormData();\r\n        formData.append('keluhan_id', add?.data?.id_keluhan?.id_keluhan);\r\n        for (let index = 0; index < filesLocal.length; index++) {\r\n          formData.append(`path[${index}]`, filesLocal[index])\r\n        }\r\n        await lampiranFile({ body: formData }).unwrap();\r\n      }\r\n      const dataNotification = await doPostNotification(add?.data?.id_keluhan);\r\n      if (dataNotification?.status === 'Success' || dataNotification?.status === 'success') {\r\n        const dataPost = await doStoreAllNotiification(dataNotification?.notifikasi?.id_notifikasi);\r\n        if (dataPost?.status === 'Success' || dataPost?.status === 'success') {\r\n          setTimeout(() => {\r\n            resetForm();\r\n            onBtnClose();\r\n            getInfo({ status: 'success' });\r\n          }, 2000);\r\n        } else {\r\n          catchError(dataPost, true);\r\n        }\r\n      } else {\r\n        catchError(dataNotification, true);\r\n      }\r\n    } else {\r\n      catchError(add, true);\r\n    }\r\n  }\r\n\r\n  const doUpdateComplain = async (payload) => {\r\n    const body = {\r\n      nama_pelapor: payload.nama_pelapor,\r\n      nomor_pelapor: payload.nomor_pelapor,\r\n      sumber_id: payload.sumber,\r\n      detail_sumber: payload.detail_sumber,\r\n      keluhan: payload.keluhan,\r\n      pop_id: payload.pop_id,\r\n    };\r\n    // update\r\n\r\n    const update = await updateComplain({\r\n      id: detail.id_keluhan,\r\n      body: { ...body },\r\n    });\r\n    if (update.data.status === 'success' || update.data.status === 'Success') {\r\n      handleResponse(update);\r\n      setTimeout(() => {\r\n        getInfo({ status: 'success' });\r\n        onBtnClose();\r\n      }, 2000);\r\n    } else {\r\n      catchError(update, true);\r\n    }\r\n  }\r\n\r\n  const onHandleFileUpload = ($event) => {\r\n    setFilesLocal($event);\r\n  }\r\n\r\n  const handleCustomer = ($event, setFieldValue) => {\r\n    setFieldValue('kategori_pelanggan', $event.target.value);\r\n    if ($event.target.value === 'UNREGISTERED') {\r\n      setFieldValue('id_pelanggan', 'UNREGISTERED')\r\n    } else {\r\n      setFieldValue('id_pelanggan', '')\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed w-screen h-screen bg-opacity-80 bg-gray-700 top-0 left-0 bottom-0 right-0 z-50 flex justify-center\">\r\n      <div className={`modal-box h-fit max-h-fit ${styles['modal-box-custom']}`}>\r\n        <ButtonIconExit onClick={onBtnClose} />\r\n        <h3 className=\"text-lg font-bold\">\r\n          {detail === null ? 'Tambah Keluhan' : 'Ubah Keluhan'}\r\n        </h3>\r\n        <hr className=\"my-2\" />\r\n\r\n        <Formik\r\n          enableReinitialize\r\n          validationSchema={ComplainFormSchema}\r\n          initialValues={initialValues}\r\n          onSubmit={(values, { resetForm }) => {\r\n            onSubmitData(values, resetForm);\r\n          }}\r\n        >\r\n          {({\r\n            values,\r\n            errors,\r\n            isValid,\r\n            touched,\r\n            handleChange,\r\n            handleBlur,\r\n            setFieldValue,\r\n          }) => (\r\n            <Form>\r\n              <div className=\"flex flex-col md:flex-row gap-3\">\r\n                <div className=\"form-control flex-1\">\r\n                  <label htmlFor=\"pop_id\" className=\"label\">\r\n                    <span className=\"label-text\"> POP (Area Operasional)</span>\r\n                  </label>\r\n                  <Field\r\n                    component=\"select\"\r\n                    id=\"pop_id\"\r\n                    name=\"pop_id\"\r\n                    value={values.pop_id}\r\n                    onBlur={handleBlur}\r\n                    onChange={handleChange}\r\n                    className=\"select w-full max-w-full input-bordered\"\r\n                  >\r\n                    <option value=\"\" label=\"Pilih POP\">Pilih POP</option>\r\n                    {popData.data.map((item, index) => (\r\n                      <option key={index} value={item.id_pop} label={item.pop}>{item.pop}</option>\r\n                    ))}\r\n                  </Field>\r\n                  {errors.pop_id && touched.pop_id ? (\r\n                    <div className=\"label label-text text-red-500\">{errors.pop_id}</div>\r\n                  ) : null}\r\n                </div>\r\n                <div className=\"form-control flex-1\">\r\n                  <label htmlFor=\"id_pelanggan\" className=\"label\">\r\n                    <span className=\"label-text\"> Kategori Pelanggan</span>\r\n                  </label>\r\n                  <Field\r\n                    component=\"select\"\r\n                    id=\"kategori_pelanggan\"\r\n                    name=\"kategori_pelanggan\"\r\n                    value={values.kategori_pelanggan}\r\n                    onBlur={handleBlur}\r\n                    disabled={detail !== null ? true : null}\r\n                    onChange={(val) => handleCustomer(val, setFieldValue)}\r\n                    className=\"select w-full max-w-full input-bordered\"\r\n                  >\r\n                    <option value=\"\" label=\"Pilih Kategori Pelanggan\">Pilih Kategori Pelanggan</option>\r\n                    {kategoriPelanggan.map((item, index) => (\r\n                      <option key={index} value={item.value} label={item.label}>{item.label}</option>\r\n                    ))}\r\n                  </Field>\r\n                  {errors.kategori_pelanggan && touched.kategori_pelanggan ? (\r\n                    <div className=\"label label-text text-red-500\">{errors.kategori_pelanggan}</div>\r\n                  ) : null}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col md:flex-row  gap-3\">\r\n                <div className=\"form-control flex-1\">\r\n                  <label htmlFor=\"id_pelanggan\" className=\"label\">\r\n                    <span className=\"label-text\"> ID Pelanggan</span>\r\n                  </label>\r\n                  <Field\r\n                    id=\"id_pelanggan\"\r\n                    name=\"id_pelanggan\"\r\n                    placeholder=\"ID Pelanggan\"\r\n                    value={values.id_pelanggan}\r\n                    onBlur={handleBlur}\r\n                    onChange={handleChange}\r\n                    className=\"input input-md input-bordered  max-w-full\"\r\n                    disabled={(detail !== null ? true : null) || values.id_pelanggan === 'UNREGISTERED'}\r\n                  />\r\n                  {errors.id_pelanggan && touched.id_pelanggan ? (\r\n                    <div className=\"label label-text text-red-500\">{errors.id_pelanggan}</div>\r\n                  ) : null}\r\n                </div>\r\n\r\n                <div className=\"form-control flex-1\">\r\n                  <label htmlFor=\"nama_pelanggan\" className=\"label\">\r\n                    <span className=\"label-text\"> Nama Pelanggan</span>\r\n                  </label>\r\n\r\n                  <Field\r\n                    id=\"nama_pelanggan\"\r\n                    name=\"nama_pelanggan\"\r\n                    placeholder=\"Nama Pelanggan\"\r\n                    value={values.nama_pelanggan}\r\n                    onBlur={handleBlur}\r\n                    onChange={handleChange}\r\n                    className=\"input input-md input-bordered  max-w-full\"\r\n                    disabled={detail !== null ? true : null}\r\n                  />\r\n                  {errors.nama_pelanggan && touched.nama_pelanggan ? (\r\n                    <div className=\"label label-text text-red-500\">{errors.nama_pelanggan}</div>\r\n                  ) : null}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col md:flex-row  gap-3\">\r\n                <div className=\"form-control flex-1\">\r\n                  <label htmlFor=\"sumber\" className=\"label\">\r\n                    <span className=\"label-text\"> Sumber Keluhan</span>\r\n                  </label>\r\n                  <Field\r\n                    component=\"select\"\r\n                    id=\"sumber\"\r\n                    name=\"sumber\"\r\n                    value={values.sumber}\r\n                    onBlur={handleBlur}\r\n                    onChange={handleChange}\r\n                    className=\"select w-full max-w-full input-bordered\"\r\n                  >\r\n                    <option value=\"\" label=\"Pilih Sumber\">Pilih Sumber</option>\r\n                    {dataSumber.data.map((item, index) => (\r\n                      <option key={index} value={item.id_sumber} label={item.sumber}>{item.sumber}</option>\r\n                    ))}\r\n                  </Field>\r\n                  {errors.sumber && touched.sumber ? (\r\n                    <div className=\"label label-text text-red-500\">{errors.sumber}</div>\r\n                  ) : null}\r\n                </div>\r\n\r\n                <div className=\"form-control flex-1\">\r\n                  <label htmlFor=\"detail_sumber\" className=\"label\">\r\n                    <span className=\"label-text\"> Kontak Sumber Keluhan</span>\r\n                  </label>\r\n\r\n                  <Field\r\n                    id=\"detail_sumber\"\r\n                    name=\"detail_sumber\"\r\n                    placeholder=\"Kontak Sumber Keluhan\"\r\n                    value={values.detail_sumber}\r\n                    onBlur={handleBlur}\r\n                    onChange={handleChange}\r\n                    className=\"input input-md input-bordered  max-w-full\"\r\n                  />\r\n                  {errors.detail_sumber && touched.detail_sumber ? (\r\n                    <div className=\"label label-text text-red-500\">{errors.detail_sumber}</div>\r\n                  ) : null}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex flex-col md:flex-row  gap-3\">\r\n                <div className=\"form-control flex-1\">\r\n                  <label htmlFor=\"nama_pelapor\" className=\"label\">\r\n                    <span className=\"label-text\"> Nama Kontak</span>\r\n                  </label>\r\n\r\n                  <Field\r\n                    id=\"nama_pelapor\"\r\n                    name=\"nama_pelapor\"\r\n                    placeholder=\"Nama Kontak\"\r\n                    value={values.nama_pelapor}\r\n                    onBlur={handleBlur}\r\n                    onChange={handleChange}\r\n                    className=\"input input-md input-bordered  max-w-full\"\r\n                  />\r\n                  {errors.nama_pelapor && touched.nama_pelapor ? (\r\n                    <div className=\"label label-text text-red-500\">{errors.nama_pelapor}</div>\r\n                  ) : null}\r\n                </div>\r\n\r\n                <div className=\"form-control flex-1\">\r\n                  <label htmlFor=\"nomor_pelapor\" className=\"label\">\r\n                    <span className=\"label-text\"> Nomor Kontak</span>\r\n                  </label>\r\n\r\n                  <Field\r\n                    id=\"nomor_pelapor\"\r\n                    name=\"nomor_pelapor\"\r\n                    placeholder=\"Nomor Kontak\"\r\n                    value={values.nomor_pelapor}\r\n                    onBlur={handleBlur}\r\n                    onChange={handleChange}\r\n                    className=\"input input-md input-bordered  max-w-full\"\r\n                  />\r\n                  {errors.nomor_pelapor && touched.nomor_pelapor ? (\r\n                    <div className=\"label label-text text-red-500\">{errors.nomor_pelapor}</div>\r\n                  ) : null}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"form-control mt-2\">\r\n                <label htmlFor=\"keluhan\" className=\"label\">\r\n                  <span className=\"label-text\"> Keluhan Awal:</span>\r\n                </label>\r\n                <TextEditor\r\n                  setFieldValue={(val) => setFieldValue('keluhan', val)}\r\n                  value={values.keluhan}\r\n                  disabled={detail !== null ? true : false}\r\n                />\r\n                {errors.keluhan && touched.keluhan ? (\r\n                  <div className=\"label label-text text-red-500\">{errors.keluhan}</div>\r\n                ) : null}\r\n              </div>\r\n\r\n              {!detail && (\r\n                <div className=\"\">\r\n                  <UploadFile getFile={onHandleFileUpload} />\r\n                </div>\r\n\r\n              )}\r\n\r\n              <hr className=\"my-2 mt-5\" />\r\n              <div className=\"modal-action justify-center\">\r\n                <Button type=\"button\" onClick={() => onBtnClose()}>Batal</Button>\r\n                <Button type=\"submit\" disabled={!isValid} className=\"btn-success\">Simpan</Button>\r\n              </div>\r\n            </Form>\r\n          )}\r\n        </Formik>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ComplainModalForm;\r\n"],"names":["stateModal","getInfo","detail","useAddComplainMutation","addComplain","useUpdateComplainMutation","updateComplain","user","useSelector","selectCurrentUser","data","popData","selectAllPOP","useState","filesLocal","setFilesLocal","label","value","kategoriPelanggan","dispatch","useDispatch","dataSumber","selectAllSumberKeluhan","useLampiranFileMutation","lampiranFile","usePostNotificationMutation","postNotification","useStoreAllNotificationMutation","storeAllNotification","initialValues","kategori_pelanggan","id_pelanggan","nama_pelanggan","nama_pelapor","nomor_pelapor","nomor_keluhan","sumber","sumber_id","detail_sumber","keluhan","status","pop_id","onBtnClose","newState","dashboard","showAddModalComplain","showUpdateModalComplain","setModal","doStoreAllNotiification","notifikasi_id","body","unwrap","catchError","doPostNotification","keluhan_id","id_response","testSentimentData","payload","test","string","fetch","method","mode","headers","JSON","stringify","sentimen","json","resultSentimen","onSubmitData","resetForm","request","hasOwnProperty","user_id","id_user","sentimen_analisis","sentiment","lampiran","doCreate","doUpdateComplain","add","handleResponse","length","formData","FormData","append","id_keluhan","index","dataNotification","notifikasi","id_notifikasi","dataPost","setTimeout","id","update","onHandleFileUpload","$event","className","styles","onClick","enableReinitialize","validationSchema","ComplainFormSchema","onSubmit","values","errors","isValid","touched","handleChange","handleBlur","setFieldValue","htmlFor","component","name","onBlur","onChange","map","item","id_pop","pop","disabled","val","target","placeholder","id_sumber","getFile","type"],"sourceRoot":""}