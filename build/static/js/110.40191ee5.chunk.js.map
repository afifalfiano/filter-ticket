{"version":3,"file":"static/js/110.40191ee5.chunk.js","mappings":"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","sources":["pages/dashboard/Dashboard.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport loadable from '@loadable/component'\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { useAllComplainMutation } from '../../store/features/complain/complainApiSlice';\r\nimport { selectAllComplain, setComplain } from '../../store/features/complain/complainSlice';\r\nimport { useAllPOPMutation } from '../../store/features/pop/popApiSlice';\r\nimport { setPOP } from '../../store/features/pop/popSlice';\r\nimport { updateBreadcrumb } from '../../store/features/breadcrumb/breadcrumbSlice';\r\nimport { useAllSumberKeluhanMutation } from '../../store/features/sumber_keluhan/sumberKeluhanApiSlice';\r\nimport { setSumberKeluhan } from '../../store/features/sumber_keluhan/sumberKeluhanSlice';\r\nimport { selectCurrentUser } from '../../store/features/auth/authSlice';\r\nimport { selectModalState, setModal } from '../../store/features/modal/modalSlice';\r\nimport catchError from '../../services/catchError';\r\n\r\nimport { DoShowRFOTrouble, DoDelete, DoUpdate, LabelStatus, LoaderGetData, Search, Button, Modal, SelectStatusComplain, SelectPOP, LabelStatusPOP, DoDetail, DoShowRFOComplain, DoRollbackStatus, ProgressTime } from '../../components/index';\r\n\r\nconst DeleteModal = loadable(() => import('../../components/Common/DeleteModal'));\r\nconst ComplainModalForm = loadable(() => import('./modal/ComplainModalForm'));\r\nconst RFOMasalModal = loadable(() => import('./modal/RFOMasalModal'));\r\nconst ReopenModal = loadable(() => import('../history_dashboard/ReopenModal'));\r\n\r\nconst initColumns = [\r\n  'No',\r\n  'POP',\r\n  'Pelanggan',\r\n  'Kontak',\r\n  'Keluhan',\r\n  'Progress',\r\n  'Waktu',\r\n  'Status',\r\n  'Aksi',\r\n];\r\n\r\nconst Dashboard = () => {\r\n  const [columns, setColumns] = useState(initColumns);\r\n  const [statusData, setStatusData] = useState('open');\r\n  const [detail, setDetail] = useState(null);\r\n  const [showLoading, setShowLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n  const [rows, setRows] = useState([]);\r\n  const [allComplain] = useAllComplainMutation();\r\n  const dispatch = useDispatch();\r\n  const { data: user } = useSelector(selectCurrentUser);\r\n  const stateModal = useSelector(selectModalState);\r\n  const [search, setSearch] = useState('');\r\n  const [dataPOP, setdataPOP] = useState([]);\r\n  const [pop, setPOPLocal] = useState('all');\r\n  const dataRow = useSelector(selectAllComplain);\r\n\r\n  const openModal = (modal) => {\r\n    let newState;\r\n    if (modal === 'add complain') {\r\n      newState = { ...stateModal, dashboard: { ...stateModal.dashboard, showAddModalComplain: true } };\r\n    } else if (modal === 'update complain') {\r\n      newState = { ...stateModal, dashboard: { ...stateModal.dashboard, showUpdateModalComplain: true } };\r\n    } else if (modal === 'modal rfo masal') {\r\n      newState = { ...stateModal, dashboard: { ...stateModal.dashboard, showRFOTroubleModal: true } };\r\n    } else if (modal === 'delete complain') {\r\n      newState = { ...stateModal, dashboard: { ...stateModal.dashboard, showDeleteModalComplain: true } };\r\n    } else if (modal === 'revert complain') {\r\n      newState = { ...stateModal, dashboard: { ...stateModal.dashboard, showRevertModalComplain: true } };\r\n    }\r\n    dispatch(setModal(newState));\r\n    window.scrollTo(0, 0);\r\n  }\r\n\r\n  const getAllComplain = async () => {\r\n    setShowLoading(true);\r\n    try {\r\n      const data = await allComplain().unwrap();\r\n      if (data.status === 'success' || data.status === 'Success') {\r\n        let dataFix;\r\n        if (user?.role_id === 2) {\r\n          const dataFilter = data.data.filter((item) => {\r\n            if (item.pop_id === user.pop_id && item.status === statusData) {\r\n              return item;\r\n            }\r\n          });\r\n          dataFix = dataFilter\r\n          dispatch(setComplain({ data: dataFix }));\r\n          setRows(dataFix);\r\n        } else {\r\n          const dataFilter = data.data.filter((item) => {\r\n            if (item.status === statusData) {\r\n              return item;\r\n            }\r\n          });\r\n          dispatch(setComplain({ ...data }));\r\n          setRows(dataFilter);\r\n        }\r\n\r\n        setTimeout(() => {\r\n          setShowLoading(false);\r\n        }, 1500);\r\n      } else {\r\n        setRows([]);\r\n        setTimeout(() => {\r\n          setShowLoading(false);\r\n        }, 1500);\r\n        catchError(data, false);\r\n      }\r\n    } catch (error) {\r\n      setRows([]);\r\n      setTimeout(() => {\r\n        setShowLoading(false);\r\n      }, 1500);\r\n      catchError(error, false);\r\n    }\r\n  };\r\n\r\n  const onHandleSearch = (event) => {\r\n    event.preventDefault();\r\n    setSearch(event.target.value);\r\n\r\n    if (event.target.value.length > 0) {\r\n      const regex = new RegExp(search, 'ig');\r\n      const searchResult = dataRow.data.filter((item) => {\r\n        if (item.status === statusData && +item.pop.id_pop === +pop) {\r\n          if (item.id_pelanggan.match(regex) || item.nama_pelanggan.match(regex) || item.nama_pelapor.match(regex) || item.nomor_pelapor.match(regex)) {\r\n            return item;\r\n          }\r\n        }\r\n        if (item.status === statusData && pop === 'all') {\r\n          if (item.id_pelanggan.match(regex) || item.nama_pelanggan.match(regex) || item.nama_pelapor.match(regex) || item.nomor_pelapor.match(regex)) {\r\n            return item;\r\n          }\r\n        }\r\n      });\r\n      setRows(searchResult);\r\n    } else {\r\n      setRows(dataRow.data.filter((item) => {\r\n        if (item.status === statusData && +item.pop.id_pop === +pop) {\r\n          return item;\r\n        }\r\n\r\n        if (item.status === statusData && pop === 'all') {\r\n          return item;\r\n        }\r\n      }));\r\n    }\r\n  }\r\n\r\n  const handlePOP = (event) => {\r\n    setPOPLocal(event.target.value);\r\n    const dataChanged = dataRow.data.filter((item) => {\r\n      if (+item.pop_id === +event.target.value && item.status === statusData) {\r\n        return item;\r\n      }\r\n    })\r\n    if (event.target.value === 'all') {\r\n      setRows(dataRow.data.filter((item) => item.status === statusData));\r\n    } else {\r\n      setRows(dataChanged);\r\n    }\r\n  };\r\n\r\n  const [allPOP] = useAllPOPMutation();\r\n\r\n  const [allSumberKeluhan] = useAllSumberKeluhanMutation();\r\n\r\n  const getAllSumberKeluhan = async () => {\r\n    try {\r\n      const data = await allSumberKeluhan().unwrap();\r\n      if (data.status === 'success' || data.status === 'Success') {\r\n        dispatch(setSumberKeluhan({ ...data }));\r\n      } else {\r\n        catchError(data, true);\r\n      }\r\n    } catch (error) {\r\n      catchError(error, true);\r\n    }\r\n  };\r\n\r\n  const getAllPOP = async () => {\r\n    try {\r\n      const data = await allPOP().unwrap();\r\n      if (data.status === 'success' || data.status === 'Success') {\r\n        let dataFix;\r\n        if (user?.role_id === 2) {\r\n          const dataFilter = data.data.filter((pop) => {\r\n            if (pop.id_pop === user.pop_id) {\r\n              return pop;\r\n            }\r\n          });\r\n          dataFix = dataFilter\r\n        } else {\r\n          dataFix = data.data\r\n        }\r\n        dispatch(setPOP({ data: dataFix }));\r\n        setdataPOP(dataFix);\r\n      } else {\r\n        catchError(data, true);\r\n      }\r\n    } catch (error) {\r\n      catchError(error, true);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    dispatch(updateBreadcrumb([{ path: '/dashboard', title: 'Dasbor' }]))\r\n    getAllPOP()\r\n    getAllSumberKeluhan();\r\n    getAllComplain();\r\n\r\n    if (user?.role_id === 0) {\r\n      setColumns([\r\n        'No',\r\n        'POP',\r\n        'Pelanggan',\r\n        'Kontak',\r\n        'Keluhan',\r\n        'Progress',\r\n        'Waktu',\r\n        'Status',\r\n        'Sentimen',\r\n        'Aksi',\r\n      ]);\r\n    }\r\n    const intervalId = setInterval(() => {\r\n      getAllComplain();\r\n    }, 30000);\r\n    return () => {\r\n      clearInterval(intervalId);\r\n    };\r\n  }, []);\r\n\r\n\r\n  const doCreateNotificationProgress = (data) => {\r\n    if (data.notifikasi.length > 0) {\r\n      let i = 0;\r\n      data.notifikasi.forEach(item => {\r\n        item.notifikasi_read.forEach(read => {\r\n          if (+user.id_user === +read.user_id) {\r\n            if (!read.is_read) {\r\n              i++;\r\n            }\r\n          }\r\n        })\r\n      })\r\n\r\n      if (i > 0) {\r\n        return (\r\n          <span className=\"badge bg-blue-700 border-none text-white\">\r\n            + {i}\r\n          </span>\r\n        )\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleStatus = (event) => {\r\n    setStatusData(event.target.value);\r\n    const dataChanged = dataRow.data.filter((item) => {\r\n      if (item.status === event.target.value && +item.pop.id_pop === +pop) {\r\n        return item;\r\n      }\r\n      if (item.status === event.target.value && pop === 'all') {\r\n        return item;\r\n      }\r\n    })\r\n    setRows(dataChanged);\r\n  };\r\n\r\n  const getInfo = ($event) => {\r\n    if ($event.status === 'success') {\r\n      getAllComplain();\r\n    }\r\n  };\r\n\r\n\r\n  const addData = () => {\r\n    setDetail(null);\r\n    openModal('add complain');\r\n  }\r\n\r\n  const editData = (item) => {\r\n    setDetail(item);\r\n    openModal('update complain');\r\n  }\r\n\r\n  const deleteData = (item) => {\r\n    setDetail(item);\r\n    openModal('delete complain');\r\n  }\r\n\r\n  const detailData = (item) => {\r\n    navigate(`/dashboard/detail/${item.id_keluhan}`);\r\n  }\r\n\r\n  const RFOKeluhan = (item) => {\r\n    navigate(`/dashboard/rfo_single/${item.id_keluhan}?id_rfo=${item.rfo_keluhan_id}`);\r\n  }\r\n\r\n  const RFOMasal = (item) => {\r\n    setDetail(item);\r\n    openModal('modal rfo masal');\r\n  }\r\n\r\n  const RFOMasalDetail = (item) => {\r\n    setDetail(item);\r\n    navigate(\r\n      `/reason_of_outage/detail_masal/${item.rfo_gangguan_id}`\r\n    );\r\n  }\r\n\r\n  const rollbackStatus = (item) => {\r\n    setDetail(item);\r\n    openModal('revert complain');\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {statusData === 'open' && <Button onClick={addData}>Tambah</Button>}\r\n\r\n      <div className=\"gap-5 mt-5 flex flex-col md:flex md:flex-row\">\r\n        <div className=\"form-control w-full md:w-52\">\r\n          <SelectStatusComplain handleStatus={handleStatus} />\r\n        </div>\r\n\r\n        <div className=\"form-control w-full md:w-52\">\r\n          <SelectPOP dataPOP={dataPOP} handlePOP={handlePOP} />\r\n        </div>\r\n\r\n        <Search search={search} onHandleSearch={onHandleSearch} placeholder={'Cari data keluhan...'} />\r\n      </div>\r\n\r\n      <div className=\"overflow-x-auto mt-8\">\r\n        <table className=\"table table-zebra w-full\">\r\n          <thead>\r\n            <tr>\r\n              {columns.map((item, index) => (\r\n                <th key={index} className=\"text-center\">{item}</th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {rows.map((item, index) => (\r\n              <tr key={index} className=\"text-center\">\r\n                <th className=\"bg-opacity-100\">{index + 1}</th>\r\n                <td className=\"text-left\">\r\n                  <LabelStatusPOP status={item?.pop?.pop} />\r\n                </td>\r\n                <td className=\"text-left\">{(item?.id_pelanggan)} - {(item?.nama_pelanggan)}</td>\r\n                <td className=\"text-left\">{item?.nama_pelapor} - {item?.nomor_pelapor}</td>\r\n                <td className=\"text-left\">\r\n                  <div dangerouslySetInnerHTML={{ __html: item?.keluhan }} />\r\n                </td>\r\n                <td >\r\n                  <div className=\"flex gap-2\">\r\n                    <div dangerouslySetInnerHTML={{ __html: item?.balasan.length > 0 ? item?.balasan[item.balasan.length - 1].balasan.slice(0, 100) : 'Belum ada tindakan' }} className={`${item?.balasan.length === 0 ? 'text-center font-semibold badge bg-red-500 border-0 text-white' : ''}`} />\r\n                    <div>{user && doCreateNotificationProgress(item)}</div>\r\n                  </div>\r\n                </td>\r\n                <td className=\"text-left\">\r\n                  <ProgressTime item={item} />\r\n                </td>\r\n                <td>\r\n                  <LabelStatus status={item?.status} />\r\n                </td>\r\n                {user?.role_id === 0 && <td>{item?.sentimen_analisis || '-'}</td>}\r\n                <td>\r\n                  <div className=\"flex flex-row gap-3 justify-center\">\r\n                    {statusData === 'open' ? (\r\n                      <>\r\n                        <DoUpdate onClick={() => editData(item)} />\r\n                        <DoDelete onClick={() => deleteData(item)} />\r\n                        <DoDetail onClick={() => detailData(item)} />\r\n                        <DoShowRFOComplain onClick={() => RFOKeluhan(item)} />\r\n                        <DoShowRFOTrouble onClick={() => RFOMasal(item)} />\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <DoRollbackStatus onClick={() => rollbackStatus(item)} />\r\n                        <DoDetail onClick={() => detailData(item)} />\r\n                        {item.rfo_keluhan_id !== null && <DoShowRFOComplain onClick={() => RFOKeluhan(item)} />}\r\n                        {item.rfo_gangguan_id !== null && <DoShowRFOTrouble onClick={() => RFOMasalDetail(item)} />}\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n      {showLoading && <LoaderGetData />}\r\n      <Modal>\r\n        {stateModal?.dashboard?.showAddModalComplain && <ComplainModalForm stateModal={stateModal} detail={detail} getInfo={getInfo} />}\r\n        {stateModal?.dashboard?.showRFOTroubleModal && <RFOMasalModal stateModal={stateModal} detail={detail} getInfo={getInfo} />}\r\n        {stateModal?.dashboard?.showDeleteModalComplain && <DeleteModal stateModal={stateModal} detail={detail} getInfo={getInfo} title=\"keluhan\" />}\r\n        {stateModal?.dashboard?.showUpdateModalComplain && <ComplainModalForm stateModal={stateModal} detail={detail} getInfo={getInfo} />}\r\n        {stateModal?.dashboard?.showRevertModalComplain && <ReopenModal stateModal={stateModal} detail={detail} getInfo={getInfo} />}\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Dashboard;\r\n"],"names":["DeleteModal","loadable","ComplainModalForm","RFOMasalModal","ReopenModal","initColumns","useState","columns","setColumns","statusData","setStatusData","detail","setDetail","showLoading","setShowLoading","navigate","useNavigate","rows","setRows","useAllComplainMutation","allComplain","dispatch","useDispatch","user","useSelector","selectCurrentUser","data","stateModal","selectModalState","search","setSearch","dataPOP","setdataPOP","pop","setPOPLocal","dataRow","selectAllComplain","openModal","modal","newState","dashboard","showAddModalComplain","showUpdateModalComplain","showRFOTroubleModal","showDeleteModalComplain","showRevertModalComplain","setModal","window","scrollTo","getAllComplain","unwrap","status","role_id","dataFilter","filter","item","pop_id","dataFix","setComplain","setTimeout","catchError","useAllPOPMutation","allPOP","useAllSumberKeluhanMutation","allSumberKeluhan","getAllSumberKeluhan","setSumberKeluhan","getAllPOP","id_pop","setPOP","useEffect","updateBreadcrumb","path","title","intervalId","setInterval","clearInterval","doCreateNotificationProgress","notifikasi","length","i","forEach","notifikasi_read","read","id_user","user_id","is_read","className","getInfo","$event","detailData","id_keluhan","RFOKeluhan","rfo_keluhan_id","onClick","handleStatus","event","target","value","dataChanged","handlePOP","onHandleSearch","preventDefault","regex","RegExp","searchResult","id_pelanggan","match","nama_pelanggan","nama_pelapor","nomor_pelapor","placeholder","map","index","dangerouslySetInnerHTML","__html","keluhan","balasan","slice","sentimen_analisis","editData","deleteData","RFOMasal","rollbackStatus","rfo_gangguan_id","RFOMasalDetail"],"sourceRoot":""}